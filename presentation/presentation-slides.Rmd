---
title: "File Organization & Data Cleaning in R"
author: "Isabella Richmond"
date: "`r paste0('October 12, 2021 [updated: ', paste(month.name[data.table::month(Sys.Date())], data.table::mday(Sys.Date()), data.table::year(Sys.Date())), ']')`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      beforeInit: "macros-slides.js"
      highlightLines: true
      countIncrementalSlides: false
      slideNumberFormat: |
        <div class="progress-bar-container">
          <div class="progress-bar" style="width: calc(%current% / %total% * 100%);">
          </div>
        </div>`
    css: [metropolis, metropolis-fonts, "extras-slides.css"]
---

# What we are learning today & why 
- Everyone wants to learn about file organization and data cleaning/processing! So here we go! 

```{r, echo = F}
knitr::include_graphics("google1.png")
```

---
# What we are learning today & why 
- Everyone wants to learn about file organization and data cleaning/processing! So here we go! 

```{r, echo = F}
knitr::include_graphics("google2.png")
```


---
# A couple notes
- Data archiving in the Ziter lab 
  - We do have a place and and specific formatting requirements for data archiving - we can discuss this more later but this exists (reach out if this is something you want to do in the next couple of weeks)
  
```{r, echo = F}
knitr::include_graphics("righttool.PNG", dpi = 150)
```
.footnote[
[1]: [Scientific Computing](https://sciencecomputing.io)
]


---
class: important
# Part 1: Data & File Organization  
## [Tidy Data](https://www.jstatsoft.org/article/view/v059i10) 
- Tidy data is a framework for how data should be formatted for easy and efficient data cleaning created by [Hadley Wickham](http://hadley.nz/)
  - These principles are the underpinnings of `tidyverse` packages (e.g. ggplot2)   


## Principles 
1. Each variable forms a column
2. Each observation forms a row 
2. Each type of observational unit forms a table

---
class: important 

# Part 1: Data & File Organization  
## Tidy Data 
- The best way to start data/file organization is to use best practices in data collection/spreadsheet formatting 
- There are some really [common spreadsheet errors](https://datacarpentry.org/spreadsheet-ecology-lesson/02-common-mistakes/index.html) that ecologists often use when collecting data 
- We are not going to format a spreadsheet today, but I'd encourage you to take a look at that link and incorporate suggestions next time you're collecting/inputting data


---
class: important 
# Part 1: Data & File Organization 
Good file structure is important because it: 
- Ensures the integrity of your data 
- Makes it easier to share your code with people 
- Makes it easier to upload your code/data with manuscript submission 
- Makes it easier to come back after a break 

Best practices include (but are not limited to): 
- Use an R Project file so that your project is easily shareable
- Always treat raw data as read-only
- Store cleaned data in a separate folder (or distinguish clearly)
- Treat output as disposable - you should always be able to re-generate with script
- Have separate function and figure scripts

.footnote[
[1]: [Software Carpentry Project Management](https://swcarpentry.github.io/r-novice-gapminder/02-project-intro/index.html)
]

---
class: important 

# Part 1: Data & File Organization

This is how I set up my file structure with my R Projects. If you want more examples, most of my repositories on [GitHub](https://github.com/icrichmond/) are set up in in the same (or very similar manner): 

```{r, echo = F}
knitr::include_graphics("filestructure.png")
```

---
class: important 

# Part 1: Data & File Organization

This is how I set up my file structure with my R Projects. If you want more examples, most of my repositories on [GitHub](https://github.com/icrichmond/) are set up in in the same (or very similar manner): 

```{r, echo = F}
knitr::include_graphics("filestructure2.png")
```

---
class: review
# Part 2: File Organization Practice 
All together now! 
- We are going to download messy and unstructured GitHub folder from [here](https://github.com/icrichmond/ZULE-data-cleaning-workshop) & unzip 
- Then we are going to set up an R project & the file structure we just talked about  





Ok... Moving on to cleaning data in R! 

---
class: important 
# Part 3: Cleaning Data in R 
Some reasons why I clean my data in R (use the tool that works for you)
1. Reproducible 
2. Open-source and cross-platform
3. Reliable & clear 
4. High-quality graphics
5. Great community & resources
6. Scales with datasets
7. Steep learning curve with a high payoff 

.footnote[
[1]: [Data Carpentry Data Analysis & Visualiation in R for Ecologists](https://datacarpentry.org/R-ecology-lesson/00-before-we-start.html)
]

---
class: important
# Part 3: Cleaning Data in R 
Two big "ecosystems" for data cleaning in R 
.pull-left[
## `tidyverse`
- makes functions corresponding to the most common operations 
- "do one thing at a time approach" 
- chain together multiple things to make a easily understood group of operations 
- many dependencies 
]

.pull-right[
## `data.table`
- provides a high performance version of base R 
- no dependencies 
- complex syntax (I think) but it is very powerful once understood and can make your code extremely efficient by combining many operations and minimizing copying data, freeing up memory

]  

.footnote[
[1]: [tidyverse ](https://www.tidyverse.org/)
[2]: [data.table ](https://rdatatable.gitlab.io/data.table/)
[3]: [Comparison of tidyverse and data.table](https://atrebas.github.io/post/2019-03-03-datatable-dplyr/)
]
---
class: review
# Part 4: Practice cleaning messy Data in R
I have created a spreadsheet that integrates MANY of the common problems in datasets... We are going to go through step by step and clean this dataset so it is ready for analysis.  
NOTE: code is provided using both tidyverse and data.table philosophies in this workshop. Feel free to choose whichever one makes sense to you in the future (or mix & match!). Providing multiple ways to do everything was meant to give you options, not confuse you

---
class: review
# Part 4: Practice cleaning messy Data in R

Problem: 
.pull-left[
`tidyverse`
]

.pull-right[
`data.table`

]

---
class: important 
# Resources 
- [data.table in R Guide](https://www.machinelearningplus.com/data-manipulation/datatable-in-r-complete-guide/)
- [R for Reproducible Scientific Analysis](https://swcarpentry.github.io/r-novice-gapminder/)
- [Data Analysis & Visualization in R for Ecologists](https://datacarpentry.org/R-ecology-lesson/index.html)
- [Data Organization in Spreadsheets for Ecologists](https://datacarpentry.org/R-ecology-lesson/index.html)
- [Tidy Data by Hadley Wickham](https://www.jstatsoft.org/article/view/v059i10)
- [Dr. Christie Bahlai's Reproducible Quantitative Methods Course](https://cbahlai.github.io/rqm-template/)
- [Wildlife Ecology & Evolution Lab's Guide by Alec Robitaille](https://weel.gitlab.io/guide/)
- [data.table Website](https://rdatatable.gitlab.io/data.table/)
- [tidyverse Website](https://www.tidyverse.org/)
- [xaringan Website: package I used to make these slides](https://slides.yihui.org/xaringan/#1)
- [OpenRefine](https://openrefine.org/)